<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="existdb-fetch-labels.html">


<dom-module id="existdb-annotation-item">
    <template>
        <style>
            :host {
                /*display: block;*/
                font-family: sans-serif;
                font-size: 0.8rem;
                text-align: left;
            }

            /*
                        div {
                            border-top: thin solid darkslategrey;
                        }
            */
            dt, dd {
                margin: 0.125rem 0.25rem;
                display: block;
                float: left;
            }

            dd {
                min-width: 40%;
            }

            dl:after {
                content: '';
                display: block;
                clear: both;
            }

            dt {
                font-weight: bold;
                min-width: 20%;
                clear: left;
            }

            paper-item {
                /*padding: 0 4px;*/
                margin:4px;
                background: white;
            }

            paper-button {
                background: black
            }

            paper-listbox {
                width: 100%;
                background: var(--paper-blue-300);
            }

            app-toolbar {
                background: var(--paper-grey-300);
                font-size: 16px;
            }
            .type{
                font-weight: 500;
                padding:12px;
                background-color:var(--paper-blue-500);
                color:white;
                font-size:16px;
            }
            .item-body{
                padding: 10px;
                background: var(--paper-blue-300);
            }
            [hidden]{
                display:none;
            }
        </style>

        <existdb-fetch-labels id="labels" labels="{{labels}}"></existdb-fetch-labels>

        <div class="item">
            <div class="type">Type</div>

            <div class="item-body">
                <template is="dom-repeat" items="{{body}}">
                    <dl>
                        <dt>type</dt>
                        <dd>{{item.type}}</dd>
                        <dt>content</dt>
                        <dd>{{item.content}}</dd>
                    </dl>
                </template>


                <paper-listbox id="label" selected="{{selected}}" items="[[labels]]" as="label">
                    <!--<paper-item name="[[label.name]]">[[label.label]]</paper-item>-->
                    <paper-item>Image or Drawing</paper-item>
                    <paper-item>Article</paper-item>
                    <paper-item>Advertisement</paper-item>
                    <paper-item>Addtional information</paper-item>
                </paper-listbox>

                <!--
                            <template is="dom-repeat" items="{{target}}">
                                <dl>
                                    <dt>type</dt><dd>{{item.type}}</dd>
                                    <dt>top</dt><dd>{{item.top}}</dd>
                                    <dt>left</dt><dd>{{item.left}}</dd>
                                    <dt>radius</dt><dd>{{item.radius}}</dd>
                                </dl>
                            </template>
                -->
            </div>
        </div>
    </template>

    <script>
        /**
         * `existdb-annotation-item`
         *
         *
         * @customElement
         * @polymer
         * @demo demo/existdb-annotation-item.html
         */
        class ExistdbAnnotationItem extends Polymer.Element {
            static get is() {
                return 'existdb-annotation-item';
            }

            static get properties() {
                return {
                    id: {
                        type: String,
                        value: ''
                    },
                    selected:{
                        type: String,
                        value: ''
                    },
                    body: {
                        type: Array,
                        value: _ => []
                },
                target:{
                    type: Array,
                    value: _ => []
                }
            }
            }

            connectedCallback() {
                super.connectedCallback();
                console.log('targets ', this.target);
            }

            ready() {
                super.ready();
            }

            _elementCount(property) {
                return this.get([property, 'length'])
            }

            highlight() {
                this.target.map(target => {
                    const id = target.id;
                    console.log("HIGHLIGHT", id)
                    return new CustomEvent('highlight-target', {bubbles: true, composed: true, detail: {id: id}})
                }).forEach(event => this.dispatchEvent(event));
            }
        }

        window.customElements.define(ExistdbAnnotationItem.is, ExistdbAnnotationItem);
    </script>
</dom-module>
